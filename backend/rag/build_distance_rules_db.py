# backend/rag/build_distance_rules_db.py

from chromadb import PersistentClient

DB_PATH = "C:/Projects/Final_Project/backend/rag/vector_db"
client = PersistentClient(path=DB_PATH)
collection_name = "facility_rules"

# ê¸°ì¡´ ì»¬ë ‰???? œ ???¬ìƒ??
try:
    client.delete_collection(collection_name)
except:
    pass

col = client.create_collection(
    name=collection_name,
    metadata={"description": "?í™œê¶?ê±°ë¦¬ ê¸°ì? ê·œì¹™ ëª¨ìŒ"}
)

rules = [
    # -------------------------
    # SPORTS (?¤í¬ì¸ Â·ì²´?¡ì‹œ??
    # -------------------------
    ("rule_sports_01",
     "?¤í¬ì¸ Â·ì²´?¡ì‹œ?¤ì? ?í™œSOC ê°€?´ë“œ?¼ì¸(2021)???°ë¼ ?„ë³´ 10~20ë¶???500m~1km) ???‘ê·¼???ì • ê±°ë¦¬ë¡??¬ìš©?œë‹¤.",
     {"category": "sports", "distance_range": "500m~1km"}),

    ("rule_sports_02",
     "ê³µê³µì²´ìœ¡?œì„¤?€ ?í™œSOC 3?€ ?„ëµ ë³´ê³ ??2020)???°ë¥´ë©??„ë³´ ?í™œê¶?ë°˜ê²½ ??800mê°€ ?ì • ?‘ê·¼ ê±°ë¦¬ë¡??œì‹œ?œë‹¤.",
     {"category": "sports", "distance_range": "800m"}),

    # -------------------------
    # SHOPPING (?¼í•‘Â·ê·¼ë¦°?ê?)
    # -------------------------
    ("rule_shopping_01",
     "ê·¼ë¦°?í™œê¶?ê³„íš ê¸°ì? ?°êµ¬(2019)???¼í•‘Â·ê·¼ë¦°?œì„¤ ?‘ê·¼?±ì„ ?„ë³´ 300m~600m ë²”ìœ„ë¡??œì‹œ?œë‹¤.",
     {"category": "shopping", "distance_range": "300m~600m"}),

    ("rule_shopping_02",
     "?œìš¸???í™œê¶?ê³„íš ê°€?´ë“œ?¼ì¸(2014)?€ ?¸ì˜?œì„¤ ?‘ê·¼ ê°€??ê±°ë¦¬ë¥??„ë³´ 5~10ë¶???350m~600m)ë¡?ë³¸ë‹¤.",
     {"category": "shopping", "distance_range": "350m~600m"}),

    # -------------------------
    # HOSPITAL (ë³‘ì›Â·?˜ë£Œ?œì„¤)
    # -------------------------
    ("rule_hospital_01",
     "?˜ë£Œê¸°ê? ?…ì? ê¸°ì? ?°êµ¬(2016)??ë³‘ì› ê¸°ë³¸ ?í™œê¶Œì„ ?„ë³´ ??500më¡??¤ì •?œë‹¤.",
     {"category": "hospital", "distance_range": "500m"}),

    ("rule_hospital_02",
     "?‘ê¸‰?˜ë£Œì²´ê³„ ?‘ê·¼??ë¶„ì„(2018)???°ë¥´ë©??‘ê¸‰Â·ë¹„ì‘ê¸??˜ì???í™œê¶?ë°˜ê²½?€ ??500m?´ë‹¤.",
     {"category": "hospital", "distance_range": "500m"}),

    # -------------------------
    # MARKET (ë§ˆíŠ¸Â·?¬ë˜?œì¥)
    # -------------------------
    ("rule_market_01",
     "?„ì‹œ ?í™œê¶??Œë¹„?‰íƒœ ë¶„ì„(2018)?€ ?¥ë³´ê¸??í™œê¶Œì„ ?„ë³´ 300m~700m ë²”ìœ„ë¡??¤ì •?œë‹¤.",
     {"category": "market", "distance_range": "300m~700m"}),

    ("rule_market_02",
     "?ê¶Œ ?‘ê·¼???‰ê? ?°êµ¬(2020)??ê·¼ë¦° ?í™œê¶Œì˜ ?¼ë°˜?ì¸ ?‘ê·¼ ê±°ë¦¬ë¥??„ë³´ ??500më¡?ë³¸ë‹¤.",
     {"category": "market", "distance_range": "500m"}),

    # -------------------------
    # RESTAURANT (?ë‹¹Â·?¸ì‹?œì„¤)
    # -------------------------
    ("rule_restaurant_01",
     "?œìš¸???í™œê¶?ê³„íš(2014)?€ ?¸ì‹?œì„¤ ?‘ê·¼?±ì„ ?„ë³´ ??200m~400m(5ë¶??í™œê¶?ë¡??œì‹œ?œë‹¤.",
     {"category": "restaurant", "distance_range": "200m~400m"}),

    ("rule_restaurant_02",
     "ê·¼ë¦°?í™œê¶?ê³„íš ê¸°ì? ?°êµ¬(2019)???¸ì‹Â·?í™œ?¸ì˜?œì„¤ ?‘ê·¼?±ì„ 200m~500m ë²”ìœ„ë¡?ë³¸ë‹¤.",
     {"category": "restaurant", "distance_range": "200m~500m"}),

    # -------------------------
    # SCHOOL (ì´ˆÂ·ì¤‘Â·ê³?
    # -------------------------
    ("rule_school_01",
     "êµìœ¡ë¶€ ?™êµ ë°°ì¹˜ ê¸°ì?(2018)?€ ì´ˆë“±?™ìƒ ?ì • ?µí•™ê±°ë¦¬ë¥???500më¡??¤ì •?œë‹¤.",
     {"category": "school", "distance_range": "500m"}),

    ("rule_school_02",
     "?œìš¸???í™œê¶?ê³„íš ê°€?´ë“œ?¼ì¸(2014)?€ ì´ˆÂ·ì¤‘?™êµ ?‘ê·¼ ê°€??ë²”ìœ„ë¥??„ë³´ 5~10ë¶???400m~700m)ë¡??œì‹œ?œë‹¤.",
     {"category": "school", "distance_range": "400m~700m"}),

    # -------------------------
    # PARK (ê·¼ë¦°ê³µì›Â·?„ì‹œê³µì›)
    # -------------------------
    ("rule_park_01",
     "?„ì‹œê³µì› ë°??¹ì?ë²?ê¸°ì?(2018)?€ ê·¼ë¦°ê³µì›ê³??Œê³µ?ì„ 250m~500m ?„ë³´ ?í™œê¶??´ì— ë°°ì¹˜?˜ëŠ” ê²ƒì´ ?ì •?˜ë‹¤ê³?ê·œì •?œë‹¤.",
     {"category": "park", "distance_range": "250m~500m"}),

    ("rule_park_02",
     "êµ?† ?°êµ¬??ê·¼ë¦°?í™œê¶??°êµ¬(2017)??ê³µì› ?´ìš© ?í™œê¶Œì„ ?„ë³´ 300m~600m ë²”ìœ„ë¡??œì‹œ?œë‹¤.",
     {"category": "park", "distance_range": "300m~600m"}),

    # -------------------------
    # SUBWAY (ì§€?˜ì² )
    # -------------------------
    ("rule_subway_01",
     "êµ?† êµí†µë¶€ ?€ì¤‘êµ???°ê³„ ê¸°ì?(2016)?€ ì§€?˜ì²  ??„¸ê¶?ë²”ìœ„ë¥??„ë³´ 500m~800më¡??•ì˜?œë‹¤.",
     {"category": "subway", "distance_range": "500m~800m"}),

    ("rule_subway_02",
     "?œìš¸???„ì‹œì² ë„ ?‘ê·¼??ê¸°ì?(2015)?€ ì§€?˜ì²  ?‘ê·¼ ê°€??ê±°ë¦¬ë¥??„ë³´ ??600m~800më¡??œì‹œ?œë‹¤.",
     {"category": "subway", "distance_range": "600m~800m"}),

    # -------------------------
    # BUS (ë²„ìŠ¤?•ë¥˜??
    # -------------------------
    ("rule_bus_01",
     "?œêµ­êµí†µ?°êµ¬??KOTI)??ë²„ìŠ¤ ?œë¹„???‘ê·¼???°êµ¬(2019)??ë²„ìŠ¤?•ë¥˜???‘ê·¼ ê±°ë¦¬ë¥?250m~400m ë²”ìœ„ë¡??œì‹œ?œë‹¤.",
     {"category": "bus", "distance_range": "250m~400m"}),

    ("rule_bus_02",
     "?í™œêµí†µ ë³´í–‰ ?‘ê·¼???‰ê?(2018)???€ì¤‘êµ???‘ê·¼ ë²”ìœ„ë¥??„ë³´ 300m~500më¡??œì‹œ?œë‹¤.",
     {"category": "bus", "distance_range": "300m~500m"}),

    # -------------------------
    # SAFETY (ê²½ì°°?œÂ·ì†Œë°©ì„œ)
    # -------------------------
    ("rule_safety_01",
     "ê²½ì°°ì²?ì¹˜ì•ˆ?œì„¤ ?…ì? ê¸°ì?(2017)?€ ì¹˜ì•ˆ ?œë¹„???í™œê¶Œì„ ??500m~1000m ë²”ìœ„ë¡??œì‹œ?œë‹¤.",
     {"category": "safety", "distance_range": "500m~1000m"}),

    ("rule_safety_02",
     "?Œë°© ?‘ê·¼???‰ê? ë³´ê³ ??2019)???Œë°©???‘ê·¼ ?í™œê¶Œì„ ??800m ?„í›„ë¡?ë³¸ë‹¤.",
     {"category": "safety", "distance_range": "800m"}),
]


# ?€??
for rule_id, doc, metadata in rules:
    col.add(
        ids=[rule_id],
        documents=[doc],
        metadatas=[metadata]
    )

print("??facility_rules ì»¬ë ‰???ì„± ?„ë£Œ!")
